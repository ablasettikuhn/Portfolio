name: Render Rmd to HTML

on:
  push:
    branches:
      - main # Replace with default branch

jobs:
  render:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set up R
      uses: r-lib/actions/setup-r@v2
      with:
        r-version: 4.1.0

    - name: Install Pandoc
      run: |
        sudo apt-get update
        sudo apt-get install -y pandoc

    - name: Install R packages
      run: R -e 'install.packages(c("rmarkdown", "shiny", "ISAR", "tidyverse", "skimr"))'

    - name: Render Rmd to HTML
      run: R -e 'rmarkdown::render("Google_DA_Capstone_Project.Rmd")'
      
    - name: Move HTML file to docs folder
      run: mv Google_DA_Capstone_Project.html docs/
      
    - name: Commit and push rendered HTML
      run: |
        git config user.name "ablasettikuhn"
        git config user.email "alex_blasetti@hotmail.com"
        git add docs/Google_DA_Capstone_Project.html
        git commit -m "Render and publish HTML file"
        git push
